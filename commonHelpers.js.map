{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function appendHitsMarkup(data, container) {\n  const markup = data\n    .map(\n      item =>\n        `<li class=\"gallery-item\">\n          <a href=\"${item.largeImageURL}\">\n            <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" width=\"360\" height=\"152\"/>\n            <div class=\"text-content-box\">\n                <p class=\"image-text\"><span class=\"image-title\">Likes</span> ${item.likes}</p>\n                <p class=\"image-text\"><span class=\"image-title\">Views</span> ${item.views}</p>\n                <p class=\"image-text\"><span class=\"image-title\">Comments</span> ${item.comments}</p>\n                <p class=\"image-text\"><span class=\"image-title\">Downloads</span> ${item.downloads}</p>\n            </div>\n        </a>\n      </li>`\n    )\n    .join('');\n\n  container.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function clearHitsContainer(container) {\n  container.innerHTML = '';\n}\n","import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport class ImagesApiService {\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.perPage = 15;\n    this.baseUrl = 'https://pixabay.com/api/';\n    this.loadMoreButton = document.querySelector('.js-load-more-btn');\n  }\n\n  async fetchImages() {\n    const url = `${this.baseUrl}?key=42616276-59c99055eec179e7b1bf68313&q=${this.searchQuery}&lang=en&per_page=${this.perPage}&page=${this.page}`;\n    this.incrementPage();\n\n    try {\n      const response = await axios.get(url);\n      const data = response.data;\n      this.totalHits = data.totalHits;\n\n      if (data.total === 0) {\n        onError();\n        this.loadMoreButton.style.display = 'none';\n        return;\n      }\n\n      if (data.hits.length < this.perPage) {\n        this.loadMoreButton.disabled = true;\n        this.loadMoreButton.style.display = 'none';\n        onEndOfList();\n      }\n\n      return data.hits;\n    } catch (error) {\n      onEndOfList();\n      this.loadMoreButton.style.display = 'none';\n      console.log(error);\n    }\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n}\n\nexport function onError(error) {\n  iziToast.show({\n    message: `Sorry, there are no images matching <br> your search query. Please, try again!`,\n    position: 'topRight',\n    timeout: 5000,\n    backgroundColor: '#ef4040',\n    messageColor: '#ffffff',\n    messageSize: '12',\n    close: true,\n    closeOnEscape: true,\n    progressBarColor: '#B51B1B',\n    progressBar: true,\n    layout: 2,\n    maxWidth: 432,\n    maxHeigth: 88,\n    animateInside: true,\n    iconUrl: './img/x-octagon.svg',\n    transitionIn: 'fadeInRight',\n    transitionOut: 'fadeOutRight',\n  });\n}\n\nfunction onEndOfList() {\n  iziToast.show({\n    message: `We're sorry, but you've reached the end of search results.`,\n    position: 'topRight',\n    timeout: 5000,\n    backgroundColor: '#4e75ff',\n    messageColor: '#ffffff',\n    messageSize: '12',\n    close: true,\n    closeOnEscape: true,\n    progressBarColor: '#ffffff',\n    progressBar: true,\n    layout: 2,\n    maxWidth: 432,\n    maxHeigth: 88,\n    animateInside: true,\n    transitionIn: 'fadeInRight',\n    transitionOut: 'fadeOutRight',\n  });\n}\n","import axios from 'axios';\nimport { appendHitsMarkup, clearHitsContainer } from './js/render-functions';\nimport { ImagesApiService, onError } from './js/pixabay-api';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  searchForm: document.querySelector('.js-search-form'),\n  waitingText: document.querySelector('.js-waiting-text'),\n  imagesContainer: document.querySelector('.js-images-container'),\n  loadMoreButton: document.querySelector('.js-load-more-btn'),\n};\n\nconst imagesApiService = new ImagesApiService();\n\nrefs.searchForm.addEventListener('submit', onSearch);\nrefs.loadMoreButton.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  refs.waitingText.style.display = 'block';\n\n  imagesApiService.query = e.currentTarget.elements.query.value;\n  imagesApiService.resetPage();\n\n  if (imagesApiService.query === '') {\n    onError();\n    clearWaitingText();\n    refs.loadMoreButton.style.display = 'none';\n    clearHitsContainer(refs.imagesContainer);\n    return;\n  }\n\n  try {\n    const hits = await imagesApiService.fetchImages();\n    refs.loadMoreButton.style.display = 'block';\n    clearWaitingText();\n    clearHitsContainer(refs.imagesContainer);\n    appendHitsMarkup(hits, refs.imagesContainer);\n    initializeSimpleLightbox();\n  } catch (error) {\n    refs.loadMoreButton.style.display = 'none';\n    console.log('Failed to load more images');\n  }\n\n  refs.searchForm.reset();\n}\n\nasync function onLoadMore(e) {\n  e.preventDefault();\n\n  refs.waitingText.style.display = 'block';\n\n  try {\n    const hits = await imagesApiService.fetchImages();\n    clearWaitingText();\n    appendHitsMarkup(hits, refs.imagesContainer);\n    initializeSimpleLightbox();\n    window.scrollBy({\n      top:\n        document.querySelector('.gallery-item').getBoundingClientRect().height *\n        2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.log('Failed to load more images');\n  }\n}\n\nfunction clearWaitingText() {\n  refs.waitingText.style.display = 'none';\n}\n\nfunction initializeSimpleLightbox() {\n  const simpleLightbox = new SimpleLightbox('.images a', {\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n  simpleLightbox.refresh();\n}\n"],"names":["appendHitsMarkup","data","container","markup","item","clearHitsContainer","ImagesApiService","url","axios","onError","onEndOfList","error","newQuery","iziToast","refs","imagesApiService","onSearch","onLoadMore","e","clearWaitingText","hits","initializeSimpleLightbox","SimpleLightbox"],"mappings":"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"}